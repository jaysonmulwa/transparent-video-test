<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transparency Fallback Demo</title>
    <style>
        body { font-family: sans-serif; background-color: #eee; padding: 20px; }
        .section { margin-bottom: 40px; padding: 20px; border: 1px solid #ccc; background-color: white; }
        h2 { border-bottom: 2px solid #0056b3; padding-bottom: 5px; }
        .media-container { 
            width: 300px; 
            height: 200px; 
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%); /* Visual contrast to check transparency */
            position: relative; 
            overflow: hidden; 
        }

        /* 5. CSS Masking specific styles */
        .css-masked-image {
            width: 100%;
            height: 100%;
            background-color: blue;
            /* Example: Masking to a star shape */
            mask-image: url('https://transparent-video-test-one.vercel.app/png_sequence/unscreen-002.png'); 
            -webkit-mask-image: url('https://transparent-video-test-one.vercel.app/png_sequence/unscreen-002.png'); 
            mask-size: cover;
            -webkit-mask-size: cover;
            mask-repeat: no-repeat;
            -webkit-mask-repeat: no-repeat;
            background: linear-gradient(45deg, #00f, #88f);
            mask-size: contain;
            mask-position: center;
        }
    </style>
</head>
<body>
    <script src="index.js"></script>
    <h1>Transparency Fallback Demonstration</h1>

    <div class="section">
        <h2>0. Normal MP4</h2>
        <p></p>
        <div class="media-container">
            <video playsinline muted autoplay loop style="width: 100%; height: 100%;">
                <source type="video/mp4" src="https://transparent-video-test-one.vercel.app/stroke_transparent.mp4" />
            </video>
        </div>
    </div>

    <div class="section">
        <h2>1. HEVC (H.265) Video with Alpha</h2>
        <p>Testing native support for HEVC/Alpha (best-case scenario for modern iOS).</p>
        <div class="media-container">
            <video playsinline muted autoplay loop style="width: 100%; height: 100%;">
                <source type="video/quicktime; codecs=hvc1.1.6.H120.b0" src="https://transparent-video-test-one.vercel.app/sample_960x400_ocean_with_audio.mov" />
            </video>
        </div>
    </div>

    <div class="section">
        <h2>2. VP9 (WebM) Video with Alpha</h2>
        <p>Testing a common format (expected to fail on Safari/iOS, showing a solid background).</p>
        <div class="media-container">
            <!--<video src="transparent_vp9.webm" autoplay loop muted playsinline style="width: 100%; height: 100%;"></video>-->
            <!-- <video src="stroke.webm" autoplay loop muted playsinline style="width: 100%; height: 100%;"></video> -->
            <video playsinline muted autoplay loop style="width: 100%; height: 100%;">
                <source type="video/webm; codecs=vp09.00.41.08" src="stroke.webm" />
            </video>
        </div>
    </div>

    <div class="section">
        <h2>3. PNG Sequence Fallback</h2>
        <p>A simple, universal fallback (high file-size/CPU usage).</p>
        <div class="media-container">
            <img id="png-sequence" src="png_sequence/unscreen-001.png" alt="PNG Sequence" style="width: 100%; height: 100%;">
            </div>
    </div>

    <div class="section">
        <h2>4. MP4 Overlay (Chroma Key / Matte Track)</h2>
        <p>Uses two videos (color MP4 + grayscale MP4 matte) and Canvas/WebGL to blend them.</p>
        <p>Claims to be supported by iOS but does not render in my tests.</p>
        <div class="media-container">
            <canvas id="mp4-overlay-canvas" width="300" height="200"></canvas>
            <video id="color-video" src="sample_transparent.mp4" loop muted playsinline hidden></video>
            <video id="matte-video" src="grayscale.mp4" loop muted playsinline hidden></video>
        </div>
        </div>

    <div class="section">
        <h2>5. CSS Masking</h2>
        <p>Using standard CSS properties for masking (limited to shapes/images).</p>
        <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_masking/Masking">CSS Masking example.</a>
        <div class="media-container">
            <div class="css-masked-image"></div>
        </div>
    </div>

    <div class="section">
        <h2>6. Combined HEVC, VP9 Sources in Video Tag</h2>
        <p>In Chrome, it should play the stroke Video. On IOS it should play the Ocean Seagulls video.</p>
        <div class="media-container">
            <video playsinline muted autoplay loop style="width: 100%; height: 100%;">
                <source type="video/quicktime; codecs=hvc1.1.6.H120.b0" src="https://transparent-video-test-one.vercel.app/sample_960x400_ocean_with_audio.mov" />
                <source type="video/webm; codecs=vp09.00.41.08" src="stroke.webm" />
            </video>
        </div>
    </div>

</body>
</html>